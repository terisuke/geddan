# DanceFrame Backend Environment Variables
# Copy this file to .env and customize for your environment

# ========================================
# Application Settings
# ========================================

# DEBUG mode - enables detailed logging and makes Redis optional
# Set to "true" for local development
DEBUG=true

# Secret key for session encryption (change in production)
SECRET_KEY=dev-secret-key-change-me-in-production

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ========================================
# Redis Configuration
# ========================================

# Redis connection - OPTIONAL in development mode
# When DEBUG=true or REDIS_OPTIONAL=true, the backend will start without Redis
# Production should set REDIS_OPTIONAL=false to ensure Redis is available

# Option 1: Use REDIS_URL (Docker Compose / Railway)
# REDIS_URL=redis://localhost:6379/0

# Option 2: Use separate host/port (Local development)
REDIS_HOST=localhost
REDIS_PORT=6379

# Make Redis optional (true/false)
# Default: true (allows local development without Redis)
# Production: false (require Redis for task queue)
REDIS_OPTIONAL=true

# ========================================
# Celery Configuration
# ========================================

# Celery broker and result backend
# Uses Redis by default - if Redis is unavailable and optional, Celery tasks won't run
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Task time limits (seconds)
TASK_TIME_LIMIT=600
TASK_SOFT_TIME_LIMIT=540

# ========================================
# CORS Configuration
# ========================================

# Allowed origins for CORS (comma-separated)
# Development: http://localhost:3000,http://localhost:3001
# Production: https://danceframe.app
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# ========================================
# File Upload Settings
# ========================================

# Maximum upload file size (bytes)
# Default: 104857600 (100MB)
MAX_UPLOAD_SIZE=104857600

# File retention period (hours)
# Uploaded files and generated videos are auto-deleted after this period
FILE_RETENTION_HOURS=24

# ========================================
# Server Configuration
# ========================================

# Server host and port
HOST=0.0.0.0
PORT=8000

# Number of Uvicorn workers (production)
WORKERS=4

# ========================================
# Development Options
# ========================================

# Disable auto-reload for uvicorn (if you encounter "Operation not permitted")
# Use: uvicorn app.main:app --port 8000 (without --reload)
# UVICORN_NO_RELOAD=true

# Watchfiles exclusion patterns (prevent infinite reload)
# Comma-separated glob patterns
WATCHFILES_EXCLUDE=*.log,*.tmp,uploads/**,outputs/**,__pycache__/**,*.pyc,.pytest_cache/**,.coverage

# ========================================
# Notes
# ========================================

# Local Development (minimal setup):
#   - Set DEBUG=true
#   - Set REDIS_OPTIONAL=true
#   - Don't start Redis or Celery
#   - Upload API works, but analysis/generation won't run
#   - Use: uvicorn app.main:app --port 8000 (no --reload if file watch issues)

# Full Local Development:
#   - Set DEBUG=true
#   - Start Redis: redis-server
#   - Start Celery: celery -A app.celery_worker worker --loglevel=info
#   - Start FastAPI: uvicorn app.main:app --reload --port 8000

# Production:
#   - Set DEBUG=false
#   - Set REDIS_OPTIONAL=false
#   - Use managed Redis (Railway, AWS ElastiCache, etc.)
#   - Set strong SECRET_KEY
#   - Use production CORS_ORIGINS
